<tool id="phykit_root_tree" name="PhyKit function to root phylogeny using user-specified taxa." version="0.1.0" python_template_version="3.5">
    <requirements>
        <requirement type="package" version="1.11.7">phykit</requirement>
    </requirements>
     <command detect_errors="exit_code"><![CDATA[    
        phykit root_tree $input1 
        -r $input2
        -o 'out.rooted';
        cp out.rooted ${rooted_tree};

    ]]></command>
    <inputs>
        <param name="input1" type="data" format="newick" multiple="false" label="Tree file" optional="false" />
        <param name="input2" type="data" format="text" multiple="false" label="Single column file with taxa names to root the phylogeny on" optional="false" />
    </inputs>
    <outputs>
        <data name="rooted_tree" format="newick" label="Rooted tree"/>
    </outputs>
    <tests>
        <test>
            <param name="input1" value="tree_simple.tre"/>
            <param name="input2" value="tree_simple.outgroup.txt"/>
            <output name="rooted_tree" file="tree_simple.tre.rooted"/>
        </test>
    </tests>
    <help><![CDATA[

Version: 1.11.3
Citation: Steenwyk et al. 2021, Bioinformatics. doi: 10.1093/bioinformatics/btab096
Documentation link: https://jlsteenwyk.com/PhyKIT
Publication link: https://academic.oup.com/bioinformatics/article-abstract/37/16/2325/6131675

PhyKIT helps process and analyze multiple sequence alignments and phylogenies.

Generally, all functions are designed to help understand the contents of alignments
(e.g., gc content or the number of parsimony informative sites) and the shape
of trees (e.g., treeness, degree of violation of a molecular clock).

Some help messages indicate that summary statistics are reported (e.g., 
bipartition_support_stats). Summary statistics include mean, median, 25th percentile,
75th percentile, minimum, maximum, standard deviation, and variance. These functions
typically have a verbose option that allows users to get the underlying data
used to calculate summary statistics. 

Usage: phykit <command> [optional command arguments]

Command specific help messages can be viewed by adding a 
-h/--help argument after the command. For example, to see the
to see the help message for the command 'treeness', execute
"phykit treeness -h" or "phykit treeness --help".

Lastly, each function comes with aliases to save the user some
key strokes. For example, to get the help message for the 'treeness'
function, you can type "phykit tness -h". All aliases are specified
in parentheses after the long form of the function name. 

Alignment-based commands
========================
alignment_length (alias: aln_len; al)
    - calculates alignment length
alignment_length_no_gaps (alias: aln_len_no_gaps; alng)
    - calculates alignment length after removing sites with gaps
column_score (alias: cs)
    - calculate column score between a reference and query alignment
create_concatenation_matrix (alias: create_concat; cc)
    - create concatenation matrix from a set of alignments
faidx (alias: get_entry; ge)
    - extract query fasta entry from multi-fasta file              
gc_content (alias: gc)
    - calculate GC content of a fasta entries or entries thereof
pairwise_identity (alias: pairwise_id, pi)
    - calculates average pairwise identify among sequences in
      an alignment file. This is a proxy for evolutionary rate
parsimony_informative_sites (alias: pis)
    - calculates the number and percentage of parsimony
      informative sites in an alignment
relative_composition_variability (alias: rel_comp_var, rcv)
    - calculates relative composition variability in an alignment
rename_fasta_entries (alias: rename_fasta)
    - rename entries in a fasta file
sum_of_pairs_score (alias: sops; sop)
    - calculate sum-of-pairs score between a reference and query alignment
thread_dna (alias: pal2nal; p2n)
    - thread dna sequences over a protein alignment
variable_sites (alias: vs)
    - calculates the number and percentage of variable sites
      in an alignment

Tree-based commands
===================
bipartition_support_stats (alias: bss)
    - calculates summary statistics for bipartition support
branch_length_multiplier (alias: blm)
    - multiply all branch lengths by a specified factor
collapse_branches (alias: collapse; cb)
    - collapses branches according to bipartition support
covarying_evolutionary_rates (alias: cover)
    - calculates correlation in the evolutionary rate of two trees
degree_of_violation_of_a_molecular_clock (alias: dvmc)
    - reports the degree of violation of the molecular clock
evolutionary_rate (alias: evo_rate)
    - reports a tree-based estimation of evolutionary rate for a gene
hidden_paralogy_check (alias: clan_check)
    - check for monophyly of specific clades of taxa
internal_branch_stats (alias: ibs)
    - calculates summary statistics for internal branch lengths 
internode_labeler (alias: il)
    - create labels at internodes in a phylogeny
last_common_ancestor_subtree (alias: lca_subtree)
    - get last common ancestor of a set of taxa
long_branch_score (alias: lb_score; lbs)
    - calculates lb (long branch) score for taxa in a phylogeny
monophyly_check (alias: is_monophyletic)
    - determines if a set of tip names are monophyletic
nearest_neighbor_interchange (alias: nni)
    - make nearest neighbor interchange moves on a tree
patristic_distances (alias: pd)
    - calculate all pairwise distances between tips in a tree
polytomy_test (alias: polyt_test; polyt; ptt)
    - conducts a polytomy test using gene
      support frequencies
print_tree (alias: print; pt)
    - prints ascii tree
prune_tree (alias: prune)
    - prune taxa from a phylogeny
rename_tree_tips (alias: rename_tree; rename_tips)
    - renames tips in a phylogeny according to a file with
      the desired new tip names
robinson_foulds_distance (alias: rf_distance; rf_dist; rf)
    - calculates Robinson-Foulds distance between two trees
root_tree (alias: root; rt)
    - roots tree on user-specified taxa or taxon
spurious_sequence (alias: spurious_seq; ss)
    - identifies putatively spurious sequences by identifying
      branch lengths that are atypically long
tip_labels (alias: tree_labels; labels; tl)
    - print leaf names in a phylogeny
tip_to_tip_distance (alias: t2t_dist; t2t)
    - calculate tip-to-tip distance in a phylogeny
tip_to_tip_node_distance (alias: t2t_node_dist; t2t_nd)
    - calculate tip-to-tip node distance in a phylogeny
total_tree_length (alias: tree_len)
    - calculates total tree length
treeness (alias: tness)
    - reports treeness or stemminess, a measure of signal-to-
      noise ratio in a phylogeny

Alignment- and tree-based commands
==================================
saturation (alias: sat)
    - calculates saturation by examining the slope of
      patristic distance and uncorrected distances
treeness_over_rcv (alias: toverr)
    - calculates treeness/rcv, treeness, and rcv

optional arguments:
  -h, --help  show this help message and exit

    ]]></help>
    <citations>
        <citation type="bibtex">
@misc{githubPhyKIT,
  author = {LastTODO, FirstTODO},
  year = {TODO},
  title = {PhyKIT},
  publisher = {GitHub},
  journal = {GitHub repository},
  url = {https://github.com/JLSteenwyk/PhyKIT},
}</citation>
    </citations>
</tool>